<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FFmpeg Drop & Go — Download Access</title>
  <meta name="description" content="Unlock the FFmpeg Drop & Go download. Clear, step-by-step operating instructions included." />
  <style>
    :root{ --bg:#0f1115; --card:#171a20; --text:#e5e7eb; --muted:#9ca3af; --accent:#4f46e5; --accent2:#10b981; --err:#ef4444; --line:#262a33; }
    *{ box-sizing:border-box }
    html,body{ margin:0; padding:0; background:var(--bg); color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif }
    .wrap{ min-height:100vh; display:grid; place-items:center; padding:28px }
    .container{ width:100%; max-width:980px; display:grid; gap:20px }
    .grid{ display:grid; gap:20px }
    @media(min-width:920px){ .grid{ grid-template-columns:480px 1fr } }
    .card{ background:var(--card); border:1px solid var(--line); border-radius:14px; box-shadow:0 10px 30px rgba(0,0,0,.35) }
    .pad{ padding:26px }
    h1{ margin:0 0 6px; font-size:1.65rem }
    .sub{ margin:0; color:var(--muted) }
    label{ display:block; margin:12px 0 6px; font-weight:600 }
    input{ width:100%; padding:12px 14px; border-radius:10px; border:1px solid #2b303a; background:#0f1217; color:var(--text) }
    button{ width:100%; margin-top:16px; padding:12px 16px; border:0; border-radius:12px; background:var(--accent); color:#fff; font-weight:800; cursor:pointer }
    button:hover{ filter:brightness(.96) }
    .status{ margin-top:10px; font-size:.95rem }
    .status.err{ color:var(--err) }
    .status.ok{ color:var(--accent2) }
    .dl{ display:none; margin-top:16px; text-align:center }
    .dl a{ display:inline-block; padding:12px 18px; border-radius:12px; background:var(--accent2); color:#06110a; text-decoration:none; font-weight:900 }
    .small{ font-size:.9rem }
    .muted{ color:var(--muted) }
    .hr{ height:1px; background:var(--line); margin:16px 0 }
    .section h2{ margin:0 0 10px; font-size:1.2rem }
    .steps{ list-style:decimal; margin:0; padding-left:20px }
    .steps li{ margin:10px 0 }
    .kbd{ display:inline-block; padding:2px 6px; border:1px solid var(--line); border-radius:6px; background:#0f1217 }
    details{ background:#12151b; border:1px solid var(--line); border-radius:10px; padding:12px; margin-top:12px }
    summary{ cursor:pointer; font-weight:700 }
    .footer{ text-align:center; font-size:.9rem; color:var(--muted) }
  </style>
</head>
<body>
  <main class="wrap">
    <div class="container">
      <header class="card pad">
        <h1>FFmpeg Drop & Go — Download Access</h1>
        <p class="sub">Enter your info to unlock. No installs needed — ffmpeg is bundled.</p>
      </header>

      <div class="grid">
        <!-- Gate / form -->
        <section class="card pad" aria-labelledby="gateTitle">
          <h2 id="gateTitle" style="margin-top:0">Unlock the Download</h2>
          <form id="f" novalidate>
            <label for="name">Name</label>
            <input id="name" name="name" type="text" placeholder="Jane Doe" autocomplete="name" required />
            <label for="email">Email</label>
            <input id="email" name="email" type="email" placeholder="you@example.com" autocomplete="email" required />
            <button id="btn" type="submit">Submit & Continue</button>
            <div id="status" class="status" role="status" aria-live="polite"></div>

            <div id="dl" class="dl">
              <a id="dllink" href="#" download>Download Now</a>
              <p class="small muted" style="margin-top:10px">If this fails, right-click the button and choose “Save link as…”</p>
            </div>

            <div class="hr"></div>
            <p class="small muted">Direct link backup: <a id="directLink" href="#">open</a></p>
          </form>
        </section>

        <!-- Instructions -->
        <section class="card pad section" aria-labelledby="instTitle">
          <h2 id="instTitle">Operating Instructions</h2>
          <ol class="steps">
            <li><strong>Download & Extract</strong><br />
              Click the button to download the ZIP. Right-click the ZIP → <span class="kbd">Extract All…</span> into a normal folder (Desktop is fine). Do <em>not</em> run scripts from inside the ZIP.
            </li>
            <li><strong>Add Your Videos</strong><br />
              Place source videos into the <span class="kbd">incoming_videos</span> folder. Leave other folders (<span class="kbd">bin</span>, <span class="kbd">results</span>, <span class="kbd">logs</span>, <span class="kbd">tmp</span>) alone.
            </li>
            <li><strong>Run the Launcher</strong><br />
              Double-click <span class="kbd">run_windows.bat</span>. This opens PowerShell and runs the script. No installs required — the bundled <span class="kbd">bin/ffmpeg.exe</span> is used automatically.
            </li>
            <li><strong>Collect Results</strong><br />
              Finished files appear in <span class="kbd">results</span>. Logs go to <span class="kbd">logs</span>. You can ignore <span class="kbd">tmp</span> unless troubleshooting.
            </li>
          </ol>

          <div class="hr"></div>
          <ul class="small muted" style="margin:0 0 6px 18px; list-style: disc;">
            <li>If Windows SmartScreen warns you, click <em>More info</em> → <em>Run anyway</em>.</li>
            <li>Extract to a writable path (e.g., Desktop). Avoid <span class="kbd">C:\Program Files\</span>.</li>
            <li>You do <em>not</em> need to install ffmpeg or edit PATH. It’s self-contained.</li>
            <li>Don’t close the window mid-process — that stops the job.</li>
          </ul>

          <details>
            <summary>Technical verification (optional)</summary>
            <p class="small muted">The launcher runs PowerShell with <span class="kbd">-ExecutionPolicy Bypass</span> and calls the script next to it. The script resolves paths via <span class="kbd">$PSScriptRoot</span> and invokes <span class="kbd">bin/ffmpeg.exe</span> directly. No global PATH dependency.</p>
          </details>
        </section>
      </div>

      <footer class="card pad footer">
        Having trouble? Email <a id="ownerEmail" href="#"></a>
      </footer>
    </div>
  </main>

  <script>
    // ===== CONFIG: edit these =====
    // Replace the fake FILE_ID with your real Google Drive file ID
    const ZIP_PATH    = "https://drive.google.com/uc?export=download&id=1AbCdEfGh1234567890";
    const OWNER_EMAIL = "you@example.com";
    const USE_MAILTO  = false; // set true if you want it to open the user's email app after unlock

    // Wire links and footer email
    const dlLink = document.getElementById("dllink");
    const directLink = document.getElementById("directLink");
    const ownerEmailA = document.getElementById("ownerEmail");
    dlLink.href = ZIP_PATH; directLink.href = ZIP_PATH;
    ownerEmailA.textContent = OWNER_EMAIL; ownerEmailA.href = `mailto:${OWNER_EMAIL}`;

    const form = document.getElementById("f");
    const btn  = document.getElementById("btn");
    const stat = document.getElementById("status");
    const dl   = document.getElementById("dl");

    function setStatus(msg, cls){ stat.textContent = msg || ""; stat.className = "status" + (cls ? " " + cls : ""); }
    function validEmail(v){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v); }

    // Helper: show download only
    function showDownloadOnly(){
      dl.style.display = "block";
      form.style.display = "none";
      setStatus("Unlocked.", "ok");
    }

    // Already unlocked? show download immediately
    if (localStorage.getItem("dl_unlocked") === "1") showDownloadOnly();

    // Optional reset: add ?reset=1 to URL to clear unlock
    if (new URLSearchParams(location.search).get("reset") === "1") {
      localStorage.removeItem("dl_unlocked");
      localStorage.removeItem("dl_entries");
      form.style.display = "block";
      dl.style.display = "none";
      setStatus("Access reset. Please submit again.", "");
    }

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      setStatus("");
      const name  = form.name.value.trim();
      const email = form.email.value.trim();
      if (!name){ setStatus("Name is required.", "err"); return; }
      if (!email){ setStatus("Email is required.", "err"); return; }
      if (!validEmail(email)){ setStatus("Enter a valid email.", "err"); return; }

      // Minimal local record so repeat visits stay unlocked (still no server)
      try {
        const entries = JSON.parse(localStorage.getItem("dl_entries") || "[]");
        entries.push({ name, email, ts: new Date().toISOString() });
        localStorage.setItem("dl_entries", JSON.stringify(entries));
      } catch {}

      localStorage.setItem("dl_unlocked", "1");
      showDownloadOnly();

      if (USE_MAILTO){
        const subject = encodeURIComponent("Download request");
        const body = encodeURIComponent(`Name: ${name}\nEmail: ${email}\nPage: ${location.href}\nTime: ${new Date().toISOString()}`);
        setTimeout(()=>{ window.location.href = `mailto:${OWNER_EMAIL}?subject=${subject}&body=${body}`; }, 150);
      }

      setTimeout(()=>{ window.location.href = ZIP_PATH; }, 350);
    });
  </script>
</body>
</html>
